import re
BOT_TOKEN = "8588537913:AAF8yxyeQBHbpdN4aJHpfp5-DUxFvQaUb10"

# --- 2. إعدادات الأحياء (المدينة المنورة) ---
# تم ترتيبها وتنظيفها لضمان مطابقة أدق
CITIES_DISTRICTS = {
    "مكة المكرمة": [
        "الشوقيه", "العزيزيه", "الرصيفه", "بطحاء قريش", "العوالي", "الشرائع", 
        "النزهه", "الزايدي", "ولي العهد", "الكعكيه", "المسفله", "العتيبيه",
        "النواريه", "العمره", "البحيرات", "جبل النور", "سلطانه", "الخالديه"
    ],
    "جدة": [
        "الصفا", "الروضه", "النهضه", "السلامه", "النعيم", "المرجان", "ابحر", 
        "الحمدانيه", "السامر", "المنار", "الفهد", "الروابي", "السليمانيه", 
        "الفيحاء", "المطار", "البلد", "البغداديه", "الشاطئ", "النسيم", "التحليه"
    ]
}
# --- 3. معالجة النصوص (الذكاء اللغوي) ---

def normalize_text(text):
    """تنظيف وتوحيد النصوص العربية لزيادة دقة البحث عن الأحياء والطلبات"""
    if not text: return ""

    # 1. تحويل للصغير وإزالة المسافات الزائدة
    text = text.strip().lower()

    # 2. إزالة التشكيل (فتحة، ضمة، إلخ)
    text = re.sub(r"[\u064B-\u0652]", "", text)

    # 3. توحيد الحروف المتشابهة
    replacements = {
        "أ": "ا", "إ": "ا", "آ": "ا",
        "ة": "ه", "ى": "ي", "ئ": "ي", "ؤ": "و"
    }
    for old, new in replacements.items():
        text = text.replace(old, new)

    # 4. إزالة تكرار الحروف (مشوااااار -> مشوار)
    text = re.sub(r'(.)\1+', r'\1', text)

    # 5. معالجة الـ التعريف لزيادة مرونة البحث
    # نقوم بإزالة "ال" إذا كانت تجعل الكلمة أكثر من 3 حروف (مثل العزيزية -> عزيزيه)
    words = text.split()
    clean_words = []
    for w in words:
        if w.startswith("ال") and len(w) > 3:
            clean_words.append(w[2:])
        else:
            clean_words.append(w)

    return " ".join(clean_words)